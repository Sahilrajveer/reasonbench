name: Monthly reminder to maintain reasonbench

on:
  schedule:
    # Second Monday of each month at 09:00 UTC
    - cron: "0 9 8-14 * 1"
  workflow_dispatch:

jobs:
  monthly-reminder:
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      # 1️⃣ Try to find the reminder issue
      - name: Find existing reminder issue
        id: find
        uses: peter-evans/find-issue@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          title: "📅 Monthly maintenance reminder"

      # 2️⃣ If found, comment on it
      - name: Add monthly comment
        if: steps.find.outputs.issue-number != ''
        uses: peter-evans/create-or-update-comment@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          issue-number: ${{ steps.find.outputs.issue-number }}
          body: |
            👋 **Monthly reminder:** It’s time to check in on `reasonbench`!

            - 🧩 Review open issues and PRs  
            - 🧪 Re-run `devtools::check()` locally  
            - 📚 Update documentation and vignettes  
            - 🚀 Review the [ROADMAP.md](https://github.com/DiogoRibeiro7/reasonbench/blob/main/ROADMAP.md)  
            - 🧠 Plan next steps for realistic benchmarking improvements  

            _Triggered automatically on ${{ github.run_started_at }} UTC_

      # 3️⃣ If not found, create it
      - name: Create new reminder issue
        if: steps.find.outputs.issue-number == ''
        uses: peter-evans/create-issue-from-file@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          title: "📅 Monthly maintenance reminder"
          content-filepath: .github/reminder-message.md
          labels: maintenance, reminder
